{% extends "base.html" %}
{% load staticfiles %}

{% block title %}
Predict - genTB
{% endblock %}


{% block content %}

        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Predict
                <small>Upload your genetic data to make drug resistance prediction.
                </small><h1>
            </div>
        </div>

        <div class = "row">
            <div class="col-md-6 portfolio-item">
                {% if PREVIOUS_ATTEMPT_DELETED %}
                    <div class="alert alert-success" role="alert">
                        Note: Your previous dataset information, including the dropbox link, was removed.
                    </div>
                {% endif %}

                <p>To examine the frequency of individual mutations by drug resistance you can consult the <a href="{% url 'view_map_page' %}">Map function</a> for country specific data, and the <a href="{% url 'view_explore_page' %}">Explore function</a>  to examine their frequency in all of the data.</p>


                {% if not IS_LOGGED_IN %}


                <div class="panel panel-info">
                  <div class="panel-body">
                    <p>To upload a file for prediction, please:
                        {% include "login_signup_links.html" %}
                    </p>
                  </div>
                </div>

                {% else %}
                    <p>To speed up the upload process please:
                        <ol>
                            <li>Place the FASTQ or VCF files (1 or many) in a <a href="http://dropbox.com/">dropbox</a> folder.</li>
                            <li>To copy the dropbox link for this folder please find the  icon. Clicking on this will open a popup with the URL, highlight and copy this text and paste into the
                            <b>"Dropbox link"</b> box below.</li>
                            <li>For more details please consult the dropbox share page:
                        <a href="https://www.dropbox.com/help/274">https://www.dropbox.com/help/274</a></li>
                        </ol>
                    </p>
                    <!--
                    <h4><i>Upload VCF or FASTQ Files:</i></h4>
                -->
                    {% include "predict/predict_form.html" %}
               {% endif %}

            </div>

            <div class="col-md-6 portfolio-item">

<h3>FASTQ files</b></h3>
<p>Please label paired end FASTQ files as follows:</p>
    <ul>
        <li><i>isolate-name-here</i>_R1.fastq</li>
        <li><i>isolate-name-here</i>_R2.fastq</li>
    </ul>
<p>Replace “<i>isolate-name-here</i>” with your desired isolate or strain name.

<h3>vcf file</h3>
<p>VCF stands for Variant Call Format and is further described in <a href="http://samtools.github.io/hts-specs/VCFv4.2.pdf">this PDF</a>
</p>
<p>Minimal genotypic information for accurate resistance predictions are below. Genetic regions are listed in order of decreasing importance. For more detailed list of genetic variants see reference Farhat MR, Sultana R et al. under review. </p>

    <table class="table">
       <tr>
           <th align = "center">Drug</th>
           <th align = "cetner">Genes</th>
       </tr>
       <tr>
           <td>Isoniazid</td>
           <td><i>katG</i>, <i>inhA</i> promoter, <i>inhA</i>, <i>embB</i>,
               <i>iniB</i>, <i>kasA</i>, <i>embAB</i> promoter, and <i>ahpC</i>
           </td>
       </tr>
       <tr>
           <td>Rifampicin</td>
           <td><i>rpoB</i></td>
       </tr>
       <tr>
           <td>Pyrazinamide</td>
           <td><i>pncA</i> and <i>pncA</i> promoter</td>
       </tr>
       <tr>
           <td>Ethambutol</td>
           <td><i>embB</i>, <i>iniB</i>, <i>embAB</i> promoter, <i>embAB</i>, and <i>embC</i></td>
       </tr>
       <tr>
           <td>Streptomycin</td>
           <td><i>rpsL</i>, <i>rrs</i>, <i>gid</i>, and <i>rrs-rrl</i> intergenic region</td>
       </tr>
       <tr>
           <td>Ethionamide</td>
           <td><i>inhA promoter</i>, <i>ethA</i>, and <i>inhA</i></td>
       </tr>
       <tr>
           <td>Kanamycin*</td>
           <td><i>rrs</i>, <i>tlyA</i>*</td>
       </tr>
       <tr>
           <td>Capreomycin</td>
           <td><i>rrs</i></td>
       </tr>
       <tr>
           <td>Amikacin</td>
           <td><i>rrs</i></td>
       </tr>
       <tr>
           <td>Fluoroquinolones</td>
           <td><i>gyrA</i>, <i>gyrB</i></td>
       </tr>
       <tr>
           <td>Para-aminosalicylic acid</td>
           <td><i>thyA</i></td>
       </tr>
       </table>
       * Note: Gene <i>eis</i> is a predictor of kanamycin resistance, but data for this gene was not available when the predictive model was built.
        </div>
    </div>


        {% comment %}
        <div class="col-md-6" id="d3-target-div" style="padding-left:60px;">
        </div>
        <script type="text/javascript" src="{{ STATIC_URL }}{% static 'd3/d3.v3.min.js' %}"></script>
        <script type="text/javascript" src="{{ STATIC_URL }}js/app.js"></script>
        {% endcomment %}
{% endblock %}

{% block extra_footer_js %}
<script language="javascript" type="text/javascript">
<!--

function show_hide_fastq_types(){
    var file_type_val = $('#id_file_type').val();
    if (file_type_val=='fastq'){
        $('#row_id_fastq_type').show();
    }else{
        $('#row_id_fastq_type').hide();
   }
}
$(document).ready(function(){
       show_hide_fastq_types();
       // bind file type dropdown
       $( "#id_file_type" ).change(function() {
          show_hide_fastq_types();
       });
});
//-->
</script>
{% endblock %}
